# Laravel-specific configuration
option_settings:
  aws:elasticbeanstalk:application:environment:
    COMPOSER_HOME: /root
    
container_commands:
  01_install_dependencies:
    command: "composer install --no-dev --optimize-autoloader --no-interaction"
    cwd: /var/app/staging
    
  02_migrate_database:
    command: "php artisan migrate --force"
    cwd: /var/app/staging
    leader_only: true
    
  03_cache_config:
    command: "php artisan config:cache"
    cwd: /var/app/staging
    
  04_cache_routes:
    command: "php artisan route:cache"
    cwd: /var/app/staging
    
  05_cache_views:
    command: "php artisan view:cache"
    cwd: /var/app/staging
    
  06_storage_link:
    command: "php artisan storage:link"
    cwd: /var/app/staging
    
  07_set_permissions:
    command: |
      chmod -R 755 storage
      chmod -R 755 bootstrap/cache
      chown -R webapp:webapp storage
      chown -R webapp:webapp bootstrap/cache
    cwd: /var/app/staging

